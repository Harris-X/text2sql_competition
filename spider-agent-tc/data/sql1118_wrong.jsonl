{"instance_id": "sql_2", "instruction": "提取1个抽样号码包，2025.7.17-2025.7.23期间付费且不包含721号码包内的用户全量\n输出:gplayerid。", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dim_extract_311381_conf", "dws_argothek_ce1_login_di", "dws_argothek_ce1_cbt2_vplayerid_suserid_di"]}
{"instance_id": "sql_4", "instruction": "统计开服至今使用频率最高的用户昵称\n2023.07.1200 - 2025071523\n输出：昵称（唯一）、人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "昵称筛选逻辑：\nnickname按照#进行划分，取#前半部分的作为nickname\n示例：多喝热水#131234 -> 昵称：多喝热水", "table_list": ["dwd_argothek_playerlogin_hi"]}
{"instance_id": "sql_8", "instruction": "统计25年4月到25年6月，按月输出gamePodId的峰值数据与游戏对局数。\n输出：\n月份(2025-04、2025-05、2025-06)\n服务器节点\n峰值时间\n总游戏结束数\n排位结束数\n普通结束数\n极速结束数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "比赛状态逻辑:\nlower(completionState) in (\"completed\", \"surrendered\")\n限定模式（极速模式、排位模式、普通模式）对应逻辑:\nqueueId in (\"swiftplay\", \"competitive\", \"unrated\")\ncount(distinct matchId) 代表比赛场次，峰值时间取每月不同模式最高的dtEventTime", "table_list": ["dwd_argothek_matchdetails_hi"]}
{"instance_id": "sql_9", "instruction": "统计20250702手游fps最后活跃日期为近半年的用户的城市等级分布。\n输出：城市等级，用户人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "用户固定筛选逻辑:\nand saccounttype = \"-100\" -- 账户类型为-100\nand suseridtype in (\"qq\",\"wxid\") -- 用户类型为qq或wxid\nand sgamecode in (\"esports\",\"mobile_live\",\"initiatived\",\"allianceforce\",\"strategy\",\"jordass\",\"su\",\"playzone\",\"battlezone\",\"battlearena\",\"weapon\",\"playhub\",\"manager\",\"apgame\") -- 游戏代码为指定的手游fps\nand splattype = \"-100\" -- 平台类型为-100\n活跃日期逻辑:\n基于当前统计时间20250702向前计算6个月的登陆日期，即ilastactdate >= \"20250104\"\n城市等级分布：\n当前时间为20250702，城市等级分布的相关表是月表，所以需要取kp_imp_date = \"202506\"的数据作为关联数据", "table_list": ["dim_mgamejp_account_allinfo_nf", "dim_uf_player_gameinfo_mf"]}
{"instance_id": "sql_10", "instruction": "统计2023.7.12-2025.6.15，赛季bp道具皮肤的使用情况。\n输出：道具id、赛季名称、当前赛季使用人数、当前赛季购买人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "bp枪皮购买逻辑:\nand purchaseSource = \"BATTLEPASS_PROGRESS\" -- 筛选来源为BATTLEPASS_PROGRESS\nand itemtype = \"d5f120f8-ff8c-4aac-92ea-f2b5acbe9475\" -- 筛选itemtype为指定值\n枪皮使用逻辑：\nexpressionassetid is not null and expressiontypeid = \"d5f120f8-ff8c-4aac-92ea-f2b5acbe9475\"", "table_list": ["dwd_argothek_playerloadout_expressions_hi", "dwd_argothek_playerloadout_hi", "dwd_argothek_playerloadout_sprayslots_hi", "dwd_argothek_commercialization_gearid_df", "dim_argothek_seasondate_df"]}
{"instance_id": "sql_13", "instruction": "统计20230712以来，历史累计活跃30天以上，但3月12日及以后未活跃过的用户且剔除掉历史充值 1500 元以上的用户后的玩家wxid\n输出：玩家wxid\n时间统计范围:20230712-20250612", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "历史充值1500以上的用户：\nsum(ftranamt)/100 > 1500\n限制sappid in (\"qq\",\"wx\")", "table_list": ["dim_mgamejp_tbplayerid2wxid_nf", "dws_argothek_oss_portaltransaction_di", "dim_mgamejp_idconversion_wxid_qq_nf", "dws_argothek_oss_login_di", "dim_mgamejp_tbplayerid2qq_nf"]}
{"instance_id": "sql_16", "instruction": "统计：近一年（2023/7/12-2025/5/31）按段位统计所有竞技模式对局中，排除掉投降的对局情况。\n输出：日期（20230712-20250531）、段位（黑铁、...、无段位、全量段位）当日竞技模式非投降局对局数、当日竞技模式投降局对局数、当日竞技模式非投降局中 双方胜利回合差>=6和双方胜利回合差>=8的对局数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "段位筛选逻辑：\ncase\nwhen competitiveTier in (3, 4, 5) then \"黑铁\"\nwhen competitiveTier in (6, 7, 8) then \"黄铜\"\nwhen competitiveTier in (9, 10, 11) then \"白银\"\nwhen competitiveTier in (12, 13, 14) then \"黄金\"\nwhen competitiveTier in (15, 16, 17) then \"白金\"\nwhen competitiveTier in (18, 19, 20) then \"钻石\"\nwhen competitiveTier in (21, 22, 23) then \"超凡\"\nwhen competitiveTier >= 24 then \"神话及以上\"\nelse \"无段位\"\n竞技模式：模式id等于\"competitive\"\n对局筛选逻辑:\n使用completion_state筛选投降与非投降对局；使用roundsdiff筛选双方胜利回合差", "table_list": ["dwd_argothek_playermatchstats_hi"]}
{"instance_id": "sql_19", "instruction": "统计2024年5月02日-2024年5月02日，日活跃用户的周边休闲模式情况。\n\n活跃日期区间：\"20250426-20250502\"\n\n输出：\n日活跃中仅玩QuickMatch模式的玩家数\n日活跃中仅玩RushMode模式的玩家数\n日活跃中仅玩CombatArena模式的玩家数\n日活跃中仅玩以上三个模式不玩其他模式的玩家数\n日活跃中仅玩以上三个模式不玩其他模式的玩家周活跃频次", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "仅玩单一模式逻辑：\nhaving count(distinct queueid) = 1 -- 只玩一个模式\nand max(queueid) = \"xxx\" -- 模式ID为RushMode\n用户角色映射逻辑：\niareaid = \"101\"", "table_list": ["dws_argothek_oss_login_di", "dwd_argothek_playermatchstats_hi", "dim_argothek_gplayerid_vroleid_df"]}
{"instance_id": "sql_20", "instruction": "统计20240101-20240430，网吧特权用户的指标数据。\n输出：\n月份（按月：202401、202402、202403、202404）\n人均对局时长（小时）\n网吧时间占当月游戏时间比例\n有对局的天数\n排位模式时长（小时）\n排位模式组队率\n月付费率\n月ARPA\n月ARPPA\n高校特权激活率", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "排位模式：queueId=\"competitive\"\n网吧特权：inetbarlevel = 2\n高校特权：icampuslevel > 0\n网吧在线时长先筛选网吧渠道", "table_list": ["dws_argothek_oss_login_di", "dwd_argothek_playerlogout_hi", "dws_argothek_oss_portaltransaction_di", "dwd_argothek_playermatchstats_hi"]}
{"instance_id": "sql_22", "instruction": "统计：近30天用户在渠道登录的天数为5到8天，取最多天数的用户，并将用户ID转为qq\n输出：QQ\n统计日期：20250330-20250428", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "渠道筛选条件：iloginway = 3\n用户ID筛选swxid_type = \"qq\" -- 筛选swxid_type为\"qq\"\ndim_argothek_gplayerid2qqwxid_df限定20250428", "table_list": ["dws_argothek_oss_login_di", "dim_argothek_gplayerid2qqwxid_df"]}
{"instance_id": "sql_24", "instruction": "统计下列英雄和对应上线日期，新英雄上线首周的持续选择情况。限定除自定义模式，新手、训练场外所有模式\n输出：英雄id、首周选择新英雄次数超过3次的玩家、首周选择新英雄次数超过10次的玩家、首周选择过新英雄的玩家、超过3次的玩家占比、超过10次的玩家占比", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "英雄筛选逻辑：\n英雄1上线日期：2023/07/26\n英雄2上线日期：2023/11/01\n英雄3上线日期：2024/03/27\n英雄4上线日期：2024/08/29\n英雄5上线日期：2025/01/09\n英雄6上线日期：2025/03/06\n英雄1对应id:\"e370fa57-4757-3604-3648-499e1f642d3f\",\"cc8b64c8-4b25-4ff9-6e7f-37b4da43d235\"\n英雄2对应id:\"0e38b510-41a8-5780-5e8f-568b2a4f2d6c\"\n英雄3对应id:\"1dbf2edd-4729-0984-3115-daa5eed44993\"\n英雄4对应id:\"efba5359-4016-a1e5-7626-b1ae76895940\"\n英雄5对应id:\"b444168c-4e35-8076-db47-ef9bf368f384\"\n英雄6对应id:\"df1cb487-4902-002e-5c17-d28e83e78588\"\n\n对局筛选逻辑：\nprovisioningflowid = \"Matchmaking\" -- 除自定义模式、新手、训练场外所有模式", "table_list": ["dwd_argothek_playermatchdetail_hi"]}
{"instance_id": "sql_26", "instruction": "统计：2024-01-01到2024-12-16，闪了敌人x次、闪了队友x次，除自定义模式、新手、训练场外所有模式。\n输出：闪了敌人x次、闪了队友x次", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "provisioningflowid = \"Matchmaking\" -- 除自定义模式、新手、训练场外所有模式\n\n闪光弹区分逻辑：\n闪到敌人：tag = \"EnemiesBlinded\"\n闪到队友：tag = \"AlliesBlinded\"", "table_list": ["dwd_argothek_matchdetails_hi", "dwd_argothek_abilityinfo_effects_hi"]}
{"instance_id": "sql_29", "instruction": "统计周期：2024.6.18至2025年3月30日\n输出：自然周（20240617、20240624、...、20250324），玩法名称，周平均日均参与用户数，周平均日均参与率，周平均日均参与场次\n\n参与率：玩法参与用户数 / 活跃用户数\n周平均日均参与场次：每天不同玩法平均对局数再按周求平均", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "自然周指周一到周日的完整周期，通常以周一作为起始日\n\n玩法：从上往下匹配，如果满足任一条件则返回对应的玩法名称，否则返回“其他模式”。\n如果模式为“传统模式”，且子模式名称以“CG”开头，且地图为“群屿”，则返回“主题群屿”；\n如果模式为“传统模式”且地图为“群屿”，则返回“传统群屿”；\n如果模式为“传统模式”且地图为“假日群岛”，则返回“假日群岛”；\n如果模式为“传统模式”且地图为“荣耀之城”，则返回“荣耀之城”；\n如果子模式是“广域战场模式”，则返回“广域战场”；\n如果子模式是“极能形态模式”，则返回“极能形态”；\n如果模式是“组队竞技”，则返回“组竞”；\n如果模式是“休闲模式”，则返回“休闲”；\n如果模式是“乐园”，则返回“乐园”；\n如果模式是“领地”，则返回“领地”；\n如果模式是“广阔天地”，则返回“广阔天地”\n如果模式是“生存模式”，则返回“隧道”。", "table_list": ["dws_jordass_login_di", "dws_jordass_mode_roundrecord_di"]}
{"instance_id": "sql_40", "instruction": "sql_40时间段2024.3.1-2024.6.30分月看用户当月在砺刃的 新进、回流、轻度留存、中度留存、重度留存\n\n输出：月份(202403、...、202406)、新进人数、回流人数、轻度留存人数、中度留存人数、重度留存人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "新进：当月新进 \n回流：上个月未活跃的历史注册用户，在当月活跃\n轻度留存：留存用户（上个月活跃，本月也活跃的用户）在本月的活跃度1-4天\n中度留存：留存用户（上个月活跃，本月也活跃的用户）在本月的活跃度5-15天\n重度留存：留存用户（上个月活跃，本月也活跃的用户）在本月的活跃度16天及以上", "table_list": ["dws_jordass_login_di", "dws_jordass_login_df"]}
{"instance_id": "sql_41", "instruction": "统计2024.1.1～1.3，每天活跃玩家数\n输出：统计日期(20240101、20240102、20240103)、玩家数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dws_jordass_login_di"]}
{"instance_id": "sql_44", "instruction": "统计2024.01.01-2024.12.31期间，付费用户的付费区间对应的付费人数和付费金额\n输出：付费区间(小R、中R、大R、超R、未知)、付费人数、付费金额（元）\n\n付费区间：小R小于等于12，中R(12,60]，大R(60,180]，超R(180+)", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dws_jordass_water_di"]}
{"instance_id": "sql_51", "instruction": "统计4个时间段灰度玩法参与情况\n\n时间段1：周期1：2024.11.08-11.21，周期2：2024.11.22-12.4\n时间段2：周期1：2024.11.10-11.23，周期2：2024.11.24-12.4\n时间段3：周期1：2024.11.15-11.28，周期2：2024.11.29-12.4\n时间段4：周期1：2024.11.17-11.30，周期2：2024.12.1-12.4\n输出：时间段（时间段1、时间段2、时间段3、时间段4），第1个周期进入过灰度玩法的用户数，两个周期都进入过灰度的用户数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dws_jordass_buttonpress_pre_di", "dim_jordass_submodeonlinedate_conf"]}
{"instance_id": "sql_52", "instruction": "2024.10.01-10.08期间参与了参与率在后20%子玩法的用户在周期内每天参与所有乐园子玩法的数量分布\n数量分布：1，2，3，4，5，6-10，11-20，21以上\n输出：统计日期(20241001、...、20241008)、数量分布、人数\n\n参与率：每个子玩法的总对局数从高到低排名", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dws_jordass_matchlog_stat_di"]}
{"instance_id": "sql_53", "instruction": "统计2024.10.21-11.21的期间内的非新注册活跃用户并且在2024.10.14-10.20没有活跃的回流用户量级，以及这些用户在10.20的\n1.前8-14天 (10.7-10.13)有活跃的用户\n2.前15-29天有活跃的用户\n3.前30-59天有活跃的用户\n4.前60-179天有活跃的用户\n5.前180-364天有活跃的用户\n输出：回流用户量级，前8-14天有活跃的用户量级，前15-29天有活跃的用户量级，前30-59天有活跃的用户量级，前60-179天有活跃的用户量级，前180-364天有活跃的用户量级", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "dtstatdate限定使用 20241121、20240813、20240505、20240126 这4天的日期", "table_list": ["dws_jordass_login_di", "dws_jordass_login_df"]}
{"instance_id": "sql_54", "instruction": "统计2024.9.20到2024.10.20期间matchmode=1003 每种玩法参与周期内的日均参与人数和日均玩法次留\n输出：玩法、上线日期、下线日期、日均参与人数、日均玩法次留", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "玩法次留：每天参与玩法的用户在第2天也参与了该玩法\n日均次留：每种玩法周期内次留人数的平均值", "table_list": ["dwd_jordass_player_matchrecord_hi", "dim_jordass_imode_leyuan_nf"]}
{"instance_id": "sql_55", "instruction": "统计：2024.11.1-11.30，乐园当天往前上线180天以内的子玩法，按七天平均 参与率+次留+七留 算一个总排名，需要每天都提供一个榜单\n\n输出，统计日期、乐园各玩法名、平均参与率排名、次留排名、七留排名、总排名", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "7天平均参与率：当天参与人数/当天活跃人,七日内平均\n7天平均次留：当天参与且第二天也参与人数/当天参与人数,七日内平均\n7天平均七留：当天参与且第7天也参与人数/当天参与人数,七日内平均\n每个玩法在每天都有一个前七天的平均参与率、次留、七留的数值，先需要按照这三个数值排名，然后按照排名总和再order一下，比如说11.1号，玩法A在前七天也就是10.25-10.31具有前七天的平均参与和次留七留，其中参与率在同期所有玩法里排名第一，次留第三，七留第四，那总排名就是1+3+4=8，玩法B相同排名总和是10，玩法C相同排名总和是2，那整体排名就是C=2>A=8>B=10", "table_list": ["dws_jordass_matchlog_stat_di", "dws_jordass_login_di", "dim_jordass_submodeonline_nf"]}
{"instance_id": "sql_58", "instruction": "统计以下时间对应玩法id下的不同对局时长人数分布\n'20230717'-'20230723'  1310822585431254784    \n'20221116'-'20221122' 1282371711108385024    \n'20221123'-'20221129' 1287652322611036928    \n'20230301'-'20230307' 1294211358396518400    \n'20230607''20230613' 1297394991875754752     \n\n对局时长按照 [0-10min)，[10-30min)，[30min-1h)，[1h,2h)，[2h,3h)，[3h,4h)， [4h,5h)，\n[5h,6h)，[6h,7h)，[7h,8h)，[8h,9h)，[9h,10h)，[10h,∞)\t\t\n输出字段：玩法id、对局时长、人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dws_jordass_matchlog_stat_di"]}
{"instance_id": "sql_60", "instruction": "统计20250226往前180天联盟用户，联盟用户的30天滚动付费人数\n输出：统计日期（YYYYMMDD），联盟并付费的人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "联盟活跃用户统计日期：\nwhere tdbank_imp_date>=date_sub(\"20250226\",180) and tdbank_imp_date<\"20250226\"\n游戏付费流水统计日期：\nwhere dtstatdate>=date_sub(\"20250226\",210) and dtstatdate<\"20250226\" and platid=255", "table_list": ["dws_jordass_water_di", "dws_jordass_uid_login_df", "dwd_jordass_player_allianceactive_hi"]}
{"instance_id": "sql_61", "instruction": "统计2024.2.9首日累充活动领奖玩家分R\n输出：用户类型（沉默付费、历史非付费、小R、中R、大R、超R），活跃人数、首日付费人数，首日付费ARPU，前一个月有消耗点券人数\n\n沉默付费：历史付过费且前1个月没有消耗过点券\n点券的分R：\n前一个月的点券消耗总金额，小于100代表小R，[100-500)代表中R，[500,1500)代表大R，大于等于1500 -  代表超R", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "首日累充活动逻辑：\nactid = 2402096612 and awardidx between 1 and 7\n合并\nActType = 661 and RecodType = 1\n\n首日付费ARPU计算方式：新用户首日总付费金额（点券）/新用户首日充值人数\n\n点券换算公式：1:10（rmb:点券）", "table_list": ["dws_jordass_water_di", "dws_jordass_login_di", "dwd_jordass_currencylog_hi", "dws_jordass_water_df"]}
{"instance_id": "sql_62", "instruction": "统计20250226联盟前180日（包含当天）基础数据 说明：按照uid计算\n输出：统计日期（YYYYMMDD），角色DAU，联盟参与角色数，联盟完成特训任务角色数，联盟商店兑换次数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dwd_jordass_allianceshopbuy_hi", "dwd_jordass_player_allianceactive_hi", "dwd_jordass_alliancebootcamprecord_hi", "dwd_jordass_playerlogout_hi", "dwd_jordass_playerlogin_hi"]}
{"instance_id": "sql_64", "instruction": "统计：2024.10.22-2024.11.19、2024.11.22-2024.12.19、2024.10.22-10.27、2024.10.28-11.03、2024.11.04-11.10、2024.11.11-11.17、2024.11.18-11.19、2024.11.22-11.24、2024.11.25-12.01、2024.12.02-12.08、2024.12.09-12.15、2024.12.16-12.19几个时间段的最近上新的曝光用户数（UV）、曝光次数（PV）\n输出：统计日期（例:20241023）、UV、PV", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "buttontype=\"410012\"表示曝光，一条记录代表一次", "table_list": ["dws_jordass_buttonpress_pre_di"]}
{"instance_id": "sql_65", "instruction": "查询2024.11.29-2024.12.19期间的任务领取数据，并按类型汇总（跨日期）\n输出 ：日期（YYYYMMDD、汇总），类型，人数，次数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "任务领取：actid = 2411291018and acttype = 10045 and awardidx in (1, 2, 3)，一条记录代表领取一次", "table_list": ["dwd_jordass_activity_rewardrecord_hi"]}
{"instance_id": "sql_68", "instruction": "统计时间范围：25.1.28-25.2.10，新春华服id：848，841 \n输出：日期（YYDDMM），人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "新春华服：\nactivitytype in (848, 841)", "table_list": ["dwd_jordass_lotteryrecord_hi"]}
{"instance_id": "sql_77", "instruction": "统计：20230123开始7日内元素付费金额\n输出：日期（20230123-20230129），人数，元素付费金额", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "限定：reason in (189, 190)\n元素付费类型：imoneytype = 1027\n元素付费金额：imoney", "table_list": ["dwd_jordass_currencylog_hi"]}
{"instance_id": "sql_80", "instruction": "统计：2024.10.2-2025.1.8内，每七天为一个周期，上周没参与对决冠军玩法但下周参与了对决冠军玩法的用户，上下周的主玩玩法、参与玩法以及对决冠军玩法游玩时长\n输出：时间区间（2024-10-09-2025-01-08），上周主玩玩法游玩时长，上周参与玩法游玩时长，本周主玩玩法游玩时长，本周参与玩法游玩时长，本周对决冠军玩法游玩时长", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "对决冠军模式是指modename = \"乐园\" AND submodename = \"对决冠军\"\n时间固定从10.2开始计算周期，也就是说10.1实际上算作上周\n\n玩法时长保留两位小数\ncase when modename=\"传统模式\" and submodename like \"CG%\" and mapname=\"群屿\" then \"主题群屿\" \nwhen modename=\"传统模式\" and mapname=\"群屿\" then \"传统群屿\"\nwhen modename=\"传统模式\" and mapname=\"假日群岛\" then \"假日群岛\"\nwhen submodename = \"广域战场模式\" then \"广域战场\"\nWHEN submodename=\"极能形态模式\" THEN \"极能形态\"\nwhen modename=\"组队竞技\" then \"组竞\"\nwhen modename=\"休闲模式\" then \"休闲\" \nwhen modename=\"乐园\" then \"乐园\" \nwhen modename=\"领地\" then \"领地\" \nwhen modename=\"广阔天地\" then \"广阔天地\"\nwhen modename=\"生存模式\" then \"隧道\"\nelse \"其他模式\"\n\n主玩定义：从上述所以玩法中选取对局时长最长的玩法", "table_list": ["dws_jordass_mode_roundrecord_di"]}
{"instance_id": "sql_82", "instruction": "统计20220408-20220410第三人称四排用户中 玩法类型（群屿 山峦 假日群岛）赛季等级总积分的人数\n输出：玩法类型，赛季等级，总积分范围（[1,2) 、[2,3).. 左闭右开），人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "总积分计算：群屿需要乘1.2，其他乘1\n群屿: submode in (1001, 1002, 1003, 1064, 1065, 1066, 1076, 1077, 1078, 1091, 1092, 1093, 1137, 1138, 1139, 1143, 1144, 1145, 1152, 1153, 1154, 1158, 1159, 1160, 2029, 2030, 2031, 2044, 2045, 2046, 2122, 2123, 2124, 2129, 2130, 2131, 2166, 2167, 2168, 2169, 2170, 2171, 2172, 2173, 2174, 2203, 2216, 2217, 2218, 2219, 2220, 2221, 2297, 2298, 2299, 2300, 2301, 2302, 2304, 2305, 2306, 2322, 2323, 2324, 2325, 2326, 2327, 2359, 2360, 2361, 2368, 2367, 2366, 2419, 2420, 2421, 2422, 2423, 2424, 2425, 2426, 2427, 2453, 2454, 2455, 2460, 2461, 2462, 2472, 2473, 2474, 2463, 2464, 2465, 2466, 2467, 2468), 山峦: submode in (2160, 2161, 2162, 2163, 2164, 2165, 2334, 2335, 2336, 2337, 2338, 2339), 假日群岛: submode in (2396, 2397, 2398, 2399, 2400, 2401)\n第三人称四排限定mode=103\n赛季积分逻辑：ChangedRatingValue/(SurvivalTime / 60)", "table_list": ["dwd_jordass_roundflow_hi"]}
{"instance_id": "sql_84", "instruction": "统计2018年注册且近30天有活跃用户，并且在2020年9月到22年4月期间添加过好友的用户，每个月人均在线好友数\n输出：自然月（YYYYMM），人均在线好友数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "添加过好友：type=2", "table_list": ["dws_jordass_login_df", "dwd_jordass_playerlogin_hi", "dwd_jordass_friendlist_hi"]}
{"instance_id": "sql_85", "instruction": "统计 20220506-20220508，20220513-20220515 两个区间的活跃用户进入匹配对局以及是否进入微赛事的情况\n输出：统计日期（YYYYMMDD），活跃人数，匹配人数，参加微赛事人数，未参加微赛事人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "对局匹配成功 matchresult ='ok'  ；\n微赛事时间：每天19-21点", "table_list": ["dws_jordass_login_di", "dwd_jordass_player_matchrecord_hi", "dwd_jordass_roundflow_entertain_hi"]}
{"instance_id": "sql_87", "instruction": "统计2023.07.02和2023.07.09 参与乐园各子玩法的用户里，砺刃新进、回流、留存用户数\n注：新进，回流，留存都按照7天为一个周期来计算\n输出：统计日期（YYYYMMDD），玩法，类型（新进、回流、留存），人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "乐园玩法子用户筛选条件：\ninstr(substr(cbitmap,1,7),'1')>0\n回流与留存计算：\ncase when datediff(dtstatdate,dregdate)<=6 then '新进'\nwhen instr(substr(cbitmap,8,7),'1')>0 then '留存'\nwhen instr(substr(cbitmap,8,7),'1')=0 then '回流'\n注意只需要统计上述三种类型", "table_list": ["dws_jordass_login_df", "dim_jordass_leyuan_participate_cdf_nf"]}
{"instance_id": "sql_88", "instruction": "统计赛季末期（20230529-20230627）的垂类玩法轻中重度及垂类独占用户，从3.22-6.27的，每周玩法分布和段位变化情况\n输出：周期（7天为一个周期），活跃度(轻度、中度、重度、独占)，玩法（主题群屿、群屿、传统其他、休闲模式、...），段位，人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "垂类玩法轻中重度用户划分条件：\n 轻度：1-4天，中度：5-15天，重度：16-30天\n垂类独占用户筛选逻辑:\n至少玩过submode IN (1265972235155284992,1278160113246405632)模式一次且没玩过其他任何模式的用户（注意submode可为空的情况）\n垂类玩法： modename = '乐园' and submode IN (1265972235155284992,1278160113246405632\n段位截取方式：seasonmaxsegment截取第一位 1-7分别代表青铜、白银、黄金、铂金、星钻、王冠、王牌\n限定modename in ('传统模式','休闲模式','组队竞技','领地','乐园','广阔天地','创意创作间'), case when modename='传统模式' and mapname='群屿' and submode in (2557,2558,2559) then '主题群屿'\nwhen modename='传统模式' and mapname='群屿' then '群屿'\nwhen modename='传统模式' then '传统其他'\nelse modename end", "table_list": ["dwd_jordass_playerlogin_hi", "dws_jordass_mode_roundrecord_di"]}
{"instance_id": "sql_89", "instruction": "赛季末期（20230529-20230627）的垂类玩法轻中重度及垂类独占用户，从3.22-6.27的，每周砺刃登录天数 和 垂类玩法参与局数和天数分布\n输出：周期（7天为一个周期），活跃度，活跃天数，人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "垂类玩法轻中重度用户划分条件：\n when active_days between 1 and 4 then '轻度'\n when active_days between 5 and 15 then '中度'\n when active_days between 16 and 30 then '重度'\n垂类独占用户筛选逻辑:\n至少玩过submode IN (1265972235155284992,1278160113246405632)模式一次且没玩过其他任何模式的用户（注意submode可为空的情况）\n垂类玩法： modename = '乐园' and submode IN (1265972235155284992,1278160113246405632", "table_list": ["dws_jordass_login_di", "dws_jordass_mode_roundrecord_di"]}
{"instance_id": "sql_90", "instruction": "统计截至2023.6.30活跃分层，并在2023.7.01~2023.7.16未活跃，后续在2023.7.17-2023.7.23玩桥梁争夺的用户\n输出：活跃分层（360天内未活跃、180天内未活跃、90天内未活跃、60天内未活跃、30天内未活跃、14天内未活跃、7天内未活跃、7天内活跃），玩桥梁争夺人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "桥梁争夺 MatchSubModeGroup=1310822585431254784 \n使用dws_jordass_login_df，只允许dtStatDate = '20230630'", "table_list": ["dws_jordass_login_df", "dwd_jordass_player_matchrecord_hi"]}
{"instance_id": "sql_91", "instruction": "统计2023.7.12-7.18,2023.7.19-7.25的全平台活跃用户的回流情况(7留存，14留存，30留存，60留存，90留存，180留存)\n输出：统计日期（20230712，20230713...20230725），类型（新进，7，14，30，60，90，180），人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dws_jordass_login_df"]}
{"instance_id": "sql_92", "instruction": "统计日期： 上周：2023.7.5-2023.7.11 本周：2023.7.12-2023.7.18\n统计在上周全平台回流砺刃的用户中（7天以上回流、30天以上回流），本周的砺刃活跃情况（轻中重活跃和流失）\n,[1,2]为轻度，[3,5]为中度，[6,7]为重度，否则为流失。输出：回流类型（7天回流，30天回流），活跃情况（轻中重活跃和流失）,人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "活跃情况使用dws_jordass_login_di表，回流使用dws_jordass_login_df", "table_list": ["dws_jordass_login_di", "dws_jordass_login_df"]}
{"instance_id": "sql_93", "instruction": "统计2024.1到2024.5每月全平台的新增付费、持续付费和回流付费用户人数\n输出：自然月（202401,...,2024.5），类型（1对应 新增付费用户； 2对应 持续付费用户；3对应 回流付费用户）,人数，付费金额（元）", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "当月新增付费用户：用户第一笔支付在这个月\n当月持续付费用户：用户在本月的第一笔支付距离上一笔支付在30天以内\n当月回流付费用户：用户在本月的第一笔支付距离上一笔支付在30天以上", "table_list": ["dws_jordass_water_di", "dws_jordass_water_df"]}
{"instance_id": "sql_94", "instruction": "统计20241123-20241128 全平台生存模式用户注册年份的设备情况\n输出：统计日期(20241123-20241128)，设备类型（手机、模拟器），注册年份，使用设备的人数，使用设备玩生存模式人数，使用设备玩生存模式占总设备人数的比例，使用设备玩生存模式的次留率", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "设备类型：device_type 0-手机 1,5-模拟器 \n生存模式：modename='生存模式'", "table_list": ["dws_jordass_device_login_di", "dws_jordass_login_df", "dws_jordass_mode_roundrecord_di"]}
{"instance_id": "sql_98", "instruction": "统计2024.05.27-2024.6.16每天的乐园高活跃用户和砺刃高活跃用户不重复人数、\n乐园高活跃用户和砺刃高活跃用户在当天登录的不重复人数\n输出：日期（YYYYMMDD），用户类型（乐园高活、砺刃高活），用户人数，登录人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dws_jordass_login_di", "dim_jordass_packet_conf", "dws_jordass_buttonpress_pre_di"]}
{"instance_id": "sql_99", "instruction": "统计2024.6.1-2024.6.30期间乐园付费用户的砺刃和乐园付费分布,需要看不同乐园子玩法\n付费分层（小R 1-30，中小R 30-100，中R 100-500，大R 500-1500，超R 1500+，否则为未付费），乐园付费金额sum(Amount/10)\n输出：子玩法、分类（砺刃or乐园），付费分层，人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "res = 'ok'", "table_list": ["dwd_jordass_payrespond_hi"]}
{"instance_id": "sql_100", "instruction": "统计2024.3.26~2024.5.27 的玩家类型(7日回流/30日回流/新进玩家)，总人数、总付费、总付费人数，商业化类型，消耗人数，抽奖次数/购买次数，付费数 \n\n输出：日期(yyyymmdd)，玩家类型（7日回流/30日回流/新进），总人数、总付费、总付费人数，商业化类型（手册、战备、限定抽取、轮盘、元素、专属卡、直购），消耗人数，抽奖次数,付费数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "货币转化规则：轮盘、限定抽取、专属卡（*10），战备、直购、元素、手册（*1）\n抽奖次数：轮盘需要求和，其他直接计数；\n商业化类型计算逻辑：\n战备：when itemid_1 in (1515013,1515020,1515023,1515060,1515277,1515279) then '战备'\n直购：when itemid_1 not in (1515013,1515020,1515023,1515060,1515277,1515279,1515029,1515120,1515123,1515122,1515121) then '直购'\n元素：when (Reason in (189,190) and AddOrReduce=1 and iMoneyType=1027) then '元素'\n手册：when (Reason in (143,144,156,158,246,269,273) and AddOrReduce=1 and iMoneyType=1 ) then '手册'\n专属卡：select '专属卡' itype,substr(tdbank_imp_date,1,8) dt,vplayerid,sum(moneycnt)*10.0 money,count(*) icnt\n轮盘：select '轮盘' itype,substr(tdbank_imp_date,1,8) dt,vplayerid, sum(CostNum)*10.0 money,sum(LotteryRound) icnt from dwd_jordass_lotteryrecord_hi where tdbank_imp_date >= '2024032600' and tdbank_imp_date <= '2024052723' group by substr(tdbank_imp_date,1,8),vplayerid\nunion all\n限定抽取：select '限定抽取' itype,substr(tdbank_imp_date,1,8) dt,vplayerid, sum(CostNum)*10.0 CostNum,count(*) icnt from dwd_jordass_lotterylog_twostage_hi where tdbank_imp_date >= '2024032600' and tdbank_imp_date <= '2024052723' group by substr(tdbank_imp_date,1,8),vplayerid\n且只统计属于商业化类型的用户数据", "table_list": ["dwd_jordass_lotteryrecord_hi", "dwd_jordass_lotterylog_twostage_hi", "dwd_jordass_privpackagelog_hi", "dwd_jordass_currencylog_hi", "dws_jordass_login_df", "dwd_jordass_marketpurchase_hi"]}
{"instance_id": "sql_101", "instruction": "统计日(2024.9.2,2024.9.3,2025.9.8,2025.9.9) 全平台活跃用户的本赛季最高段位等信息\n输出：统计日，本赛季最高段位，活跃用户数，统计日参与主题群屿玩法用户数，参与率", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "主题群屿玩法：modename='传统模式' and submodename like 'CG%'\n段位分布：case when substr(seasonmaxsegment, 1, 1) = '1' then '青铜'\n                          when substr(seasonmaxsegment, 1, 1) = '2' then '白银'\n                          when substr(seasonmaxsegment, 1, 1) = '3' then '黄金'\n                          when substr(seasonmaxsegment, 1, 1) = '4' then '铂金'\n                          when substr(seasonmaxsegment, 1, 1) = '5' then '星钻'\n                          when substr(seasonmaxsegment, 1, 1) = '6' then '王冠'\n                          when substr(seasonmaxsegment, 1, 1) >= '7' then '王牌'\n                          else '无段位'\n\t            end", "table_list": ["dws_jordass_mode_roundrecord_di", "dws_jordass_login_di", "dwd_jordass_playerlogin_hi"]}
{"instance_id": "sql_103", "instruction": "统计2025.9.1到9.10每天productid的参与直购购买人数，直购购买金额以及数量，当天注册人数\n输出：统计日期(yyyymmdd),productid,直购购买人数,直购购买金额,直购购买数量", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "productid的参与直购：op='take' and opres='ok'\n\tand productid in ('package_6','package_18','outfit_pack','weapon_pack')", "table_list": ["dws_jordass_login_df", "dwd_jordass_directpaycommflow_hi"]}
{"instance_id": "sql_105", "instruction": "统计20240101-20250601全平台每天充值金额数和消耗金币数\n输出：统计日期(yyyymmdd)，充值金额数，消耗金币数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "消耗金币：AddOrReduce=1 and imoneytype=1\n 充值和消耗金币都直接使用imoney", "table_list": ["dws_jordass_water_di", "dwd_jordass_currencylog_hi"]}
{"instance_id": "sql_108", "instruction": "统计2025.4月24日，全平台周流失 +  双周流失 +月流失 包 + 近30天登陆小于3天的低活跃号码包\n输出：类型（iweek，doubleiweek，imonth，30dayxioayu3day）、QQ 号", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dws_jordass_login_df", "dws_jordass_login_di", "dim_mgamejp_tbplayerid2qq_nf"]}
{"instance_id": "sql_109", "instruction": "统计 20250424-20250508 期间 传统和休闲的胜利情况\n\n 胜利数分布层次：1,2-10,11-20,21-50,51-80,81-100，101-200,201-500,501以上\n 输出：胜利数分布层次，人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "传统模式： mode in(101,102,103,401,402,403)\n 休闲：mode in(201,202,203,601,602,603) \n 胜利：teamrank =1", "table_list": ["dwd_jordass_roundlog_funnymode_hi", "dwd_jordass_roundflow_hi"]}
{"instance_id": "sql_110", "instruction": "统计20220413-20220421全平台每天活跃的次留，3留，7留情况（分活动和登录）\n输出：统计日期(yyyymmdd),活动人数，登录次留，登录3留，登录7留，活动次留，活动3留，活动7留", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "活动:actid = 2201123904", "table_list": ["dws_jordass_login_di", "dwd_jordass_activity_rewardrecord_hi"]}
{"instance_id": "sql_111", "instruction": "统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点", "table_list": ["dwd_jordass_vsteaminfectlog_hi"]}
{"instance_id": "sql_112", "instruction": "统计2022.04.23-2022.04.30和2022.05.01-2022.05.08传统模式存活时长达到90分钟的玩家人数，每日人数\n输出：统计日期(yyyymmdd)，人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "传统模式mode in(101,102,103,401,402,403)", "table_list": ["dwd_jordass_roundflow_hi"]}
{"instance_id": "sql_113", "instruction": "统计20220425-20220508组竞商店购买情况\n输出：统计日期（YYYYMMDD），商店id，人数，次数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dwd_jordass_vsteamshoplog_hi"]}
{"instance_id": "sql_115", "instruction": "统计 玩家参与\n\t新年竞赛杯（20240202-20240204，20240209-20240211）\n\t明星竞赛杯（20231208-20231210，20231215-20231217）\n\t众竞赛道（20231006-20231008，20230929-20231001，20230922-20230924）\n\t珍禽竞赛杯（20230721-20230723，20230728-20230730）\n\t都会竞速（20230519-20230611，20230616-20230625）\n\t寒域竞赛杯（20230505-20230507，20230512-20230514）\n\t飞跃竞赛杯（20230121-20230127）\n\t联队竞赛杯（20221125-20221127，20221202-20221204）\n\t职赛杯（20220819-20220821，20220826-20220828）\n\t夏日假期竞赛杯（20220722-20220724，20220729-20220731）\n\t众投竞赛（20220506-20220508，20220513-20220515，20220520-20220522）且matchmode为（1503,1603）的期数\n\t输出：每个玩家参与的不相同的期数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dwd_jordass_player_matchrecord_hi"]}
{"instance_id": "sql_116", "instruction": "统计全平台20250225存量用户的类型（近三个月流失，近三个月活跃但近三个月无付费，近三个月活跃且有付费），历史段位，历史付费分层情况\n\t输出：用户类型，历史段位，历史付费分层，人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "付费分层：\n\t\t0 \n\t\t(0-1200]\n\t\t(1200-6000]\n\t\t(6000-18000]\n\t\t(18000+]\n历史段位：MAX(historymaxsegment)", "table_list": ["dws_jordass_login_df", "dws_jordass_water_di", "dws_jordass_uid_login_df", "dws_jordass_water_df"]}
{"instance_id": "sql_117", "instruction": "统计全平台20250331-20250510当天活跃前30用户回流类型   （活跃，7日回流，14日回流，30日回流），人数\n\t输出：用户回流类型（活跃，7日回流，14日回流，30日回流）， 人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dws_jordass_login_df"]}
{"instance_id": "sql_118", "instruction": "统计20240426-20240505期间活动为1193536的曝光情况\n曝光：itype='1'\n参与：itype in ('10','200','201','202','203','204','31','32','33','34','35','702','703')\n输出：曝光参与情况（曝光未参与，曝光且参与）,人数，传统模式人数，传统模式对局数，传统模式对局时长，活跃人数，活跃时长，专业赛人数，专业赛局数（按照记录数）", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "注意将曝光未参与中无记录的null值统一转化为0\n用户过滤条件：platid=255\n赛事id：TournamentID = 30002", "table_list": ["dws_jordass_mode_roundrecord_di", "dws_jordass_login_di", "dwd_jordass_playerprofstagechange_hi", "dwd_jordass_mysteryplaylog_hi"]}
{"instance_id": "sql_119", "instruction": "2025年4月29日，2025年6月1日这两天\n在后续半个月未登录用户，在后续半个月有登录用户：\n输出：统计日期（yyyymmdd）,用户类型（后续半个月未登录，后续半个月有登录，新增、7日以内留存（不含当天的前七日后面同理）、7~14日回流、14~30日回流、30~90日回流、90日以上回流的用户量级），人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "", "table_list": ["dws_jordass_login_df", "dws_jordass_login_di"]}
{"instance_id": "sql_120", "instruction": "统计用户（2025.7月24~7月25日持续活跃，2025.7.24活跃7.25流失到盘外），且帐号体系为qq的性别人数\n输出：用户类型（7月24~7月25日持续活跃，7.24活跃7.25流失到盘外）,性别,人数", "db_id": "final_algorithm_competition", "external_knowledge": "common_knowledge.md", "knowledge": "n流失盘外：\nWHERE dtstatdate='20250725' \n           AND platid = 255 \n           AND substr(cbitmap,1,2)='01')\n需要将vplayerid转化为qq，体系转化用到字段：iqq, splayerid\n用户在盘内数据：dtstatdate='20250725' AND saccounttype='-100' AND sgamecode='-100' AND splattype='-100' AND splat='-100'", "table_list": ["dws_mgamejp_login_user_activity_di", "dws_jordass_login_df", "dim_mgamejp_tbplayerid2qq_nf", "dws_jordass_uid_login_df"]}